# ============================================================================
# Production Environment Variables for VisaBuddy Backend
# ============================================================================
# Copy this file to .env and fill in values for your environment
# NEVER commit .env file - use Railway/GitHub secrets for production

# ============================================================================
# Environment
# ============================================================================
NODE_ENV=production
PORT=3000
LOG_LEVEL=info

# ============================================================================
# Database (Supabase PostgreSQL)
# ============================================================================
# Format: postgresql://user:password@host:port/database
DATABASE_URL=postgresql://postgres:PASSWORD@supabase-host.supabase.co:5432/postgres

# Connection pooling settings
DATABASE_POOL_MIN=5
DATABASE_POOL_MAX=20
DATABASE_POOL_IDLE_TIMEOUT=30000
DATABASE_POOL_CONNECTION_TIMEOUT=2000

# ============================================================================
# Authentication & Security
# ============================================================================
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_SECRET=your_secure_jwt_secret_min_32_characters_long_12345678901234567
JWT_EXPIRY=7d
REFRESH_TOKEN_EXPIRY=30d

# CORS - comma-separated origins
CORS_ORIGIN=https://visabuddy-web.railway.app,https://visabuddy.app

# Rate limiting
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_MAX_AUTH_REQUESTS=5

# ============================================================================
# API Configuration
# ============================================================================
API_URL=https://your-api-domain.railway.app
FRONTEND_URL=https://visabuddy-web.railway.app

# ============================================================================
# Google OAuth (Optional)
# ============================================================================
# Get from https://console.cloud.google.com
GOOGLE_CLIENT_ID=your_google_client_id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your_google_client_secret
GOOGLE_OAUTH_CALLBACK=https://your-api-domain.railway.app/api/auth/google/callback

# ============================================================================
# Storage Configuration
# ============================================================================
# Options: local, firebase, aws-s3, supabase-storage
STORAGE_PROVIDER=firebase

# Local storage (development)
STORAGE_LOCAL_PATH=./uploads

# Firebase Storage (production)
FIREBASE_PROJECT_ID=your-firebase-project-id
FIREBASE_PRIVATE_KEY_ID=your-key-id
FIREBASE_PRIVATE_KEY=-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n
FIREBASE_CLIENT_EMAIL=firebase-adminsdk@your-project.iam.gserviceaccount.com
FIREBASE_CLIENT_ID=123456789
FIREBASE_AUTH_URI=https://accounts.google.com/o/oauth2/auth
FIREBASE_TOKEN_URI=https://oauth2.googleapis.com/token
FIREBASE_AUTH_PROVIDER_X509_CERT_URL=https://www.googleapis.com/oauth2/v1/certs
FIREBASE_CLIENT_X509_CERT_URL=https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk%40your-project.iam.gserviceaccount.com

# AWS S3 (alternative)
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_S3_BUCKET=visabuddy-documents
AWS_S3_URL=https://visabuddy-documents.s3.amazonaws.com

# ============================================================================
# Redis Caching (Optional)
# ============================================================================
# Format: redis://user:password@host:port
REDIS_URL=redis://default:password@redis-host.upstash.io:6379

# Cache settings
CACHE_ENABLED=true
CACHE_TTL_USER=3600              # 1 hour in seconds
CACHE_TTL_COUNTRIES=86400        # 24 hours
CACHE_TTL_VISA_TYPES=86400       # 24 hours
CACHE_TTL_CHAT_SESSION=28800     # 8 hours

# ============================================================================
# Email Configuration (Optional)
# ============================================================================
# For password reset, notifications, etc.
EMAIL_PROVIDER=sendgrid          # sendgrid, mailgun, smtp
SENDGRID_API_KEY=your_sendgrid_api_key
EMAIL_FROM=noreply@visabuddy.app

# SMTP (alternative)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your_app_password
SMTP_FROM=noreply@visabuddy.app

# ============================================================================
# Payment Gateway Configuration
# ============================================================================
# Payme (primary)
PAYME_MERCHANT_ID=your_payme_merchant_id
PAYME_SECRET_KEY=your_payme_secret_key

# Click
CLICK_MERCHANT_ID=your_click_merchant_id
CLICK_MERCHANT_USER_ID=your_click_user_id
CLICK_SECRET_KEY=your_click_secret_key

# Stripe (fallback/international)
STRIPE_PUBLISHABLE_KEY=pk_live_your_key
STRIPE_SECRET_KEY=sk_live_your_key
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret

# ============================================================================
# OpenAI API (for AI features)
# ============================================================================
OPENAI_API_KEY=sk-your_openai_api_key
OPENAI_MODEL=gpt-4
OPENAI_MAX_TOKENS=2000

# ============================================================================
# Firebase Cloud Messaging (for notifications)
# ============================================================================
FCM_PROJECT_ID=your-firebase-project-id
FCM_PRIVATE_KEY=-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n
FCM_CLIENT_EMAIL=firebase-adminsdk@your-project.iam.gserviceaccount.com

# ============================================================================
# Sentry (Error tracking - Optional)
# ============================================================================
SENTRY_DSN=https://key@sentry.io/project_id
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1

# ============================================================================
# Analytics & Monitoring
# ============================================================================
# Google Analytics
GOOGLE_ANALYTICS_ID=UA-XXXXXXX-X

# Mixpanel (optional)
MIXPANEL_TOKEN=your_mixpanel_token

# ============================================================================
# Feature Flags (Optional)
# ============================================================================
FEATURE_FLAG_AI_CHAT=true
FEATURE_FLAG_PAYMENT_INTEGRATION=true
FEATURE_FLAG_NOTIFICATIONS=true
FEATURE_FLAG_ANALYTICS=true

# ============================================================================
# Logging & Debugging
# ============================================================================
# Log levels: error, warn, info, debug, trace
LOG_LEVEL=info
LOG_FORMAT=json                  # json or text
LOG_DESTINATION=console          # console, file, or both

# File logging
LOG_FILE_PATH=./logs/app.log
LOG_FILE_MAX_SIZE=10485760       # 10MB
LOG_FILE_MAX_FILES=5

# ============================================================================
# Performance & Optimization
# ============================================================================
# Query optimization
QUERY_TIMEOUT_MS=30000
ENABLE_QUERY_LOGGING=false
ENABLE_SLOW_QUERY_LOGGING=true
SLOW_QUERY_THRESHOLD_MS=1000

# Compression
ENABLE_COMPRESSION=true
COMPRESSION_LEVEL=6
COMPRESSION_MIN_SIZE=1024        # 1KB

# ============================================================================
# Development & Testing
# ============================================================================
# These should ONLY be enabled in development
ENABLE_SWAGGER=false
ENABLE_PLAYGROUND=false
SEED_DATABASE=false
